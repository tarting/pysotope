# pysotope

A Python 3 module and command line tool for reducing Double Spike Isotope
measurements acquired on the IsoprobeT and Phoenix instruments at the
Geology Section at the University of Copenhagen. 


# User guide

## Installing

Get a working install of python e.g. via the Anaconda python distribution
(Used for testing on Windows10, MacOS Mojave, and Manjaro GNU/Linux). If
using system python on GNU platforms it  is recommended to setup a virtual
environment prior to installing.

Install the package by downloading/cloning this repository navigating to
the cloned folder and running:

``` 
python setup.py install
```

This will install the packages listed in the requirements.txt file as well
as the pysotope library and command.

Check that pysotope is installed by importing the pysotope library in
python: Run ```python [return]``` in the commandline to launch the python
shell followed by: ```import pysotope [return]```. If no errors are
reported, pysotope is installed correctly. Type ```exit() [return]``` to
exit the python shell.


## Using the software

Pysotope requires a specific directory structure, and works best if
a separate folder is used per sample-set or project. The data_root directory
must contain one appropriate `.json` specification file and a folder
containing the data as .xls files or .raw folders from the IsoWorks
software. 

```
| project_root/

    | Cd_data_root/
        | Cd_spec_file.json
        | data_dir/
            | run1 2189.xls
            | run2 2190.xls
            ...
            
    | Cr_data_root/
        | Cr_spec_file.json
        | data_dir/
            | run1.raw/
              | run1 2191.xls
            | run2.raw/
              | run2 2192.xls
            ...

```

Running pysotope is then a matter of opening a console (e.g. anaconda
prompt on windows, or a terminal on MacOS and Linux. 

Navigate to the data_root directory using the `cd` commmand and launch the
pysotope command in the following order.

```
pysotope init 'data_dir'
```

This command generates a list of datafiles saved as external_variables.xlsx. Now
modify this file to include sample weight, spike weight, and spike concentration.
The existing columns can be edited to exclude parts of the recorded data e.g. in
case of missing signal, to exclude entire runs without signal etc.
Any data in columns added to the right of the initial rows will be carried
on to the final results file. Any modifications made to the list persist
through reruns of the init command. In this way you can add more data file
by simply dropping them into the data directory an re-running the pysotope init
command.

```
pysotope invert 'external_variables.xlsx'
```

This command uses the list generated by the init command and the
specification file to invert the double spike data, and produces
a results.xlsx with summarized data for each run, and an
results_cycles.csv containing each collected cycle for every run.

```
pysotope plot results.xlsx
```

This command creates summary diagrams for each bead, and collected summary
for all runs. These are put as png files in a GFX folder. The summary
diagrams display each run in separate colors, cycles excluded from mean
calculation as red crosses, as well as 2 standard deviation and standard
error fields, for both individual runs and summarized across a bead run.














